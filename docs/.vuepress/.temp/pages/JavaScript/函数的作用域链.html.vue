<template><div><p>æ¥çœ‹çœ‹ä¸‹é¢çš„ä»£ç ï¼š</p>
<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre v-pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"Lydia"</span></span>
<span class="line"><span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">21</span></span>
<span class="line"><span class="token keyword">const</span> city <span class="token operator">=</span> <span class="token string">"San Francisco"</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">getPersonInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> name <span class="token operator">=</span> <span class="token string">"Sarah"</span></span>
<span class="line">  <span class="token keyword">const</span> age <span class="token operator">=</span> <span class="token number">22</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> and lives in </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>city<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">getPersonInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre>
<div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>We're invoking the <code v-pre>getPersonInfo</code> function, which returns a string containing the values of the <code v-pre>name</code>, <code v-pre>age</code> and <code v-pre>city</code> variables:<br>
æˆ‘ä»¬æ­£åœ¨è°ƒç”¨ getPersonInfo å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†è¿”å›ä¸€ä¸ªåŒ…å«å§“åã€å¹´é¾„å’ŒåŸå¸‚å˜é‡å€¼çš„å­—ç¬¦ä¸²ï¼š<code v-pre>Sarah is 22 and lives in San Francisco</code>.</p>
<p>But, the <code v-pre>getPersonInfo</code> function doesn't contain a variable named city ğŸ¤¨? How did it know the value of city?</p>
<p>First, memory space is set up for the different contexts.<br>
é¦–å…ˆï¼Œä¸ºä¸åŒçš„ä¸Šä¸‹æ–‡è®¾ç½®å†…å­˜ç©ºé—´ã€‚</p>
<p>We have the default global context (<code v-pre>window</code> in a browser, <code v-pre>global</code> in Node),<br>
æˆ‘ä»¬æœ‰é»˜è®¤çš„å…¨å±€ä¸Šä¸‹æ–‡ï¼ˆæµè§ˆå™¨ä¸­çš„<code v-pre>window</code>ï¼ŒNode ä¸­çš„ <code v-pre>global</code>ä¸Šä¸‹æ–‡ï¼‰ï¼Œ</p>
<p>and a local context for the <code v-pre>getPersonInfo</code> function which has been invoked.<br>
ä»¥åŠç”¨äºè°ƒç”¨ <code v-pre>getPersonInfo</code> å‡½æ•°çš„æœ¬åœ°ä¸Šä¸‹æ–‡ã€‚</p>
<p>Each context also has a scope chain.<br>
æ¯ä¸ªä¸Šä¸‹æ–‡è¿˜æœ‰ä¸€ä¸ªä½œç”¨åŸŸé“¾ã€‚</p>
<p>For the <code v-pre>getPersonInfo</code> function, the scope chain looks something like this :<br>
å¯¹äº <code v-pre>getPersonInfo</code> å‡½æ•°ï¼Œä½œç”¨åŸŸé“¾çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<p>local execution context -&gt; local scope chain
æœ¬åœ°æ‰§è¡Œä¸Šä¸‹æ–‡ -&gt; æœ¬åœ°ä½œç”¨åŸŸé“¾</p>
<p><img src="@source/images/20240623001.png" alt="ä½œç”¨åŸŸé“¾"></p>
<p>The scope chain is basically a &quot;chain of references&quot; to objects<br>
ä½œç”¨åŸŸé“¾åŸºæœ¬ä¸Šæ˜¯å¯¹è±¡çš„ &quot;å¼•ç”¨é“¾&quot;ï¼Œ</p>
<p>that contain references to values (and other scopes)
that are referencable in that execution context.<br>
å…¶ä¸­åŒ…å«å¯¹è¯¥æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­å¯å¼•ç”¨çš„å€¼ï¼ˆå’Œå…¶ä»–ä½œç”¨åŸŸï¼‰çš„å¼•ç”¨ã€‚</p>
<p>In the following examples,<br>
åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ</p>
<p>the <code v-pre>key/value</code> pairs in the execution contexts represent the references that the scope chain has to the variables.<br>
æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­çš„é”®/å€¼å¯¹è¡¨ç¤ºä½œç”¨åŸŸé“¾å¯¹å˜é‡çš„å¼•ç”¨ã€‚</p>
<p><img src="@source/images/20240623002.png" alt="ä½œç”¨åŸŸé“¾å¯¹å˜é‡çš„å¼•ç”¨"></p>
<p>The scope chain of the global execution context has a reference to 3 variables: name with the value Lydia, age with the value 21, and city with the value San Francisco.<br>
å…¨å±€æ‰§è¡Œä¸Šä¸‹æ–‡çš„ä½œç”¨åŸŸé“¾å¼•ç”¨äº† 3 ä¸ªå˜é‡ï¼šå§“åï¼ˆå€¼ä¸º Lydiaï¼‰ã€å¹´é¾„ï¼ˆå€¼ä¸º 21ï¼‰å’ŒåŸå¸‚ï¼ˆå€¼ä¸ºæ—§é‡‘å±±ï¼‰ã€‚</p>
<p>In the local context, we have a reference to 2 variables: name with the value Sarah, and age with the value 22.<br>
åœ¨æœ¬åœ°ä¸Šä¸‹æ–‡ä¸­ï¼Œæˆ‘ä»¬å¼•ç”¨äº† 2 ä¸ªå˜é‡ï¼šå§“åï¼ˆå€¼ä¸º Sarahï¼‰å’Œå¹´é¾„ï¼ˆå€¼ä¸º 22ï¼‰ã€‚</p>
<p>When we try to access the variables in the <code v-pre>getPersonInfo</code> function, the engine first checks the local scope chain.<br>
å½“æˆ‘ä»¬å°è¯•è®¿é—® <code v-pre>getPersonInfo</code> å‡½æ•°ä¸­çš„å˜é‡æ—¶ï¼Œå¼•æ“ä¼šé¦–å…ˆæ£€æŸ¥æœ¬åœ°ä½œç”¨åŸŸé“¾ã€‚</p>
<p><img src="@source/images/20240623003.gif" alt="æœ¬åœ°ä½œç”¨åŸŸé“¾"></p>
<p>In the global context,<br>
åœ¨å…¨å±€ä¸Šä¸‹æ–‡ä¸­ï¼Œ</p>
<p>we declared the variable city with the value of San Francisco,<br>
æˆ‘ä»¬å£°æ˜äº†å€¼ä¸º San Francisco çš„å˜é‡ cityï¼Œ</p>
<p>thus has a reference to the variable city.<br>
å› æ­¤æœ‰äº†å¯¹å˜é‡ city çš„å¼•ç”¨ã€‚</p>
<p>Now that we have a value for the variable,<br>
ç°åœ¨æˆ‘ä»¬æœ‰äº†å˜é‡çš„å€¼ï¼Œ</p>
<p>the function <code v-pre>getPersonInfo</code> can return the string Sarah is 22 and lives in San Francisco ğŸ‰<br>
å‡½æ•° <code v-pre>getPersonInfo</code> å¯ä»¥è¿”å›å­—ç¬¦ä¸² Sarah is 22 and lives in San Francisco ğŸ‰</p>
<p>We can go down the scope chain, but we can't go up the scope chain.<br>
æˆ‘ä»¬å¯ä»¥å‘ä¸‹ç§»åŠ¨ä½œç”¨åŸŸé“¾ï¼Œä½†ä¸èƒ½å‘ä¸Šç§»åŠ¨ä½œç”¨åŸŸé“¾ã€‚</p>
<p><a href="https://dev.to/lydiahallie/javascript-visualized-scope-chain-13pd" target="_blank" rel="noopener noreferrer">JavaScript Visualized: Scope (Chain)</a></p>
</div></template>


